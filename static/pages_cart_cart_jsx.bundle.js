"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk"] = self["webpackChunk"] || []).push([["pages_cart_cart_jsx"],{

/***/ "./components/notification.js":
/*!************************************!*\
  !*** ./components/notification.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FailNotify: () => (/* binding */ FailNotify),\n/* harmony export */   SuccessNotify: () => (/* binding */ SuccessNotify)\n/* harmony export */ });\n/* harmony import */ var sweetalert2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sweetalert2 */ \"./node_modules/.pnpm/sweetalert2@11.7.27/node_modules/sweetalert2/dist/sweetalert2.all.js\");\n/* harmony import */ var sweetalert2__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sweetalert2__WEBPACK_IMPORTED_MODULE_0__);\n\n\nconst SuccessNotify = (title) =>\n  sweetalert2__WEBPACK_IMPORTED_MODULE_0___default().fire({\n    icon: \"success\",\n    title: title,\n    timer: 1500,\n    showConfirmButton: false,\n  });\n\nconst FailNotify = (title) =>\n  sweetalert2__WEBPACK_IMPORTED_MODULE_0___default().fire({\n    icon: \"error\",\n    title: title,\n    timer: 1500,\n    showConfirmButton: false,\n  });\n\n\n//# sourceURL=webpack:///./components/notification.js?");

/***/ }),

/***/ "./pages/cart/cart.jsx":
/*!*****************************!*\
  !*** ./pages/cart/cart.jsx ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Component: () => (/* binding */ Component)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/.pnpm/react-router-dom@6.15.0_react-dom@18.2.0_react@18.2.0/node_modules/react-router-dom/dist/index.js\");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/.pnpm/react-router@6.15.0_react@18.2.0/node_modules/react-router/dist/index.js\");\n/* harmony import */ var _components_notification_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/components/notification.js */ \"./components/notification.js\");\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n\n\nvar CartLowerBar = function CartLowerBar() {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \" cart_lower\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"cart_lower_container\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__.Link, {\n    className: \"w-2/5 cart_lower_img_area\",\n    to: \"/\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"img\", {\n    className: \"cart_lower_img\",\n    src: \"/static/img/logobar_white.png\",\n    alt: \"\"\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"cart_logo_text\"\n  }, \"\\u8CFC\\u7269\\u8ECA\")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"cart_search_bar\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"input\", {\n    type: \"text\",\n    name: \"\",\n    id: \"\",\n    className: \"cart_search_input\"\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"button\", {\n    className: \"cart_search_btn\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"img\", {\n    src: \"/static/img/search.svg\",\n    alt: \"\",\n    className: \"\"\n  })))));\n};\nvar ContentTitle = function ContentTitle() {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"cart_title title\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"title_btn_area\"\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"\",\n    style: {\n      width: \"45%\"\n    }\n  }, \"\\u5546\\u54C1\"), [\"單價\", \"數量\", \"總計\", \"操作\"].map(function (i) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n      className: \"title_text\",\n      style: {\n        width: i === \"數量\" ? \"14%\" : \"12%\"\n      }\n    }, i);\n  }));\n};\nvar Order_title = function Order_title(_ref) {\n  var shop_name = _ref.shop_name,\n    _onClick = _ref.onClick,\n    isChecked = _ref.isChecked;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"order_title title\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"title_btn_area\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"input\", {\n    type: \"checkbox\",\n    className: \"title_btn\",\n    id: shop_name,\n    onClick: function onClick() {\n      return _onClick(shop_name);\n    },\n    checked: isChecked\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"title_text\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"a\", {\n    href: \"\"\n  }, shop_name)));\n};\nvar Product = function Product(_ref2) {\n  var item = _ref2.item,\n    _onClick2 = _ref2.onClick,\n    isChecked = _ref2.isChecked,\n    update = _ref2.update;\n  var _React$useState = react__WEBPACK_IMPORTED_MODULE_0___default().useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    disable = _React$useState2[0],\n    setable = _React$useState2[1];\n  var handle_update_num = function handle_update_num(val) {\n    var next = item.count + val;\n    if (next <= 0 || next > item.remain) {\n      return;\n    } else {\n      setable(true);\n      // 後端處理\n      fetch(\"/api/product/UploadCartNum\", {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          id: item.id,\n          new_count: next\n        })\n      }).then(function (res) {\n        if (res.status === 200) {\n          return res.json();\n        }\n      }).then(function (data) {\n        if (data.cause === 0) {\n          return true;\n        }\n      }).then(function (res) {\n        if (res === true) {\n          update(item.id, next);\n          setable(false);\n        }\n      });\n    }\n  };\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"product_container\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"title_btn_area\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"input\", {\n    type: \"checkbox\",\n    className: \"title_btn\",\n    name: item.id,\n    onClick: function onClick() {\n      return _onClick2({\n        id: item.id,\n        shop_name: item.shop_name,\n        remain: item.remain\n      });\n    },\n    checked: isChecked\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"product_info_container\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"product_img !w-[100px] !h-[100px]\",\n    style: {\n      backgroundImage: \"url(\".concat(item.photo.slice(1), \")\")\n    }\n  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", null, item.name)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"w-[12%] flex justify-center\"\n  }, \"$\", item.price), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"w-[14%] flex justify-center\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"product_number_container\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"button\", {\n    className: \"product_number_btn\",\n    onClick: function onClick() {\n      return handle_update_num(-1);\n    },\n    disabled: disable\n  }, \"-\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"product_number !text-center\"\n  }, item.count), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"button\", {\n    className: \"product_number_btn\",\n    onClick: function onClick() {\n      return handle_update_num(1);\n    },\n    disabled: disable\n  }, \"+\"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"w-[12%] flex justify-center\"\n  }, \"$\", item.count * item.price), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"w-[12%] flex justify-center\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"button\", null, \"X\")));\n};\nvar Footer = function Footer(_ref3) {\n  var price = _ref3.price,\n    num = _ref3.num,\n    onClick = _ref3.onClick;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"creat_order\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"text-lg\"\n  }, \"\\u7E3D\\u91D1\\u984D\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", null, \"(\".concat(num, \"\\u500B\\u5546\\u54C1): \")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"create_order_price px-1\"\n  }, \"\".concat(price)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"button\", {\n    className: \"create_order_btn\",\n    onClick: onClick\n  }, \"\\u53BB\\u8CB7\\u55AE\"));\n};\nvar Component = function Component() {\n  var _React$useState3 = react__WEBPACK_IMPORTED_MODULE_0___default().useState([]),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    products = _React$useState4[0],\n    setproduct = _React$useState4[1];\n  var _React$useState5 = react__WEBPACK_IMPORTED_MODULE_0___default().useState([]),\n    _React$useState6 = _slicedToArray(_React$useState5, 2),\n    selection = _React$useState6[0],\n    setSelection = _React$useState6[1];\n  var navigation = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_3__.useNavigate)();\n  var select_product = function select_product(product) {\n    var copy_select = selection.slice(0); // 複製\n    // 做商品個別檢查\n    // 檢查陣列中是否有重複的值\n\n    var dup = false;\n    var _iterator = _createForOfIteratorHelper(selection),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var select = _step.value;\n        if (select.id === product.id) {\n          dup = true;\n          break;\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n    if (dup) {\n      var index = selection.indexOf(product);\n      copy_select.splice(index, 1);\n    } else {\n      // 若是選擇新的商品要檢查是否為別商片的物品\n      if (selection.length === 0) {\n        copy_select.push(product);\n      } else {\n        if (selection[0].shop_name !== product.shop_name) {\n          copy_select = [product];\n        } else {\n          copy_select.push(product);\n        }\n      }\n    }\n    setSelection(copy_select);\n  };\n  var get_title_check = function get_title_check(shop_name) {\n    var _iterator2 = _createForOfIteratorHelper(products[shop_name]),\n      _step2;\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var product = _step2.value;\n        var dup = false;\n        var _iterator3 = _createForOfIteratorHelper(selection),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var select = _step3.value;\n            if (select.id === product.id) {\n              dup = true;\n              break;\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n        if (!dup) {\n          return false;\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n    return true;\n  };\n  var get_item_check = function get_item_check(id) {\n    var _iterator4 = _createForOfIteratorHelper(selection),\n      _step4;\n    try {\n      for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n        var select = _step4.value;\n        if (select.id === id) {\n          return true;\n        }\n      }\n    } catch (err) {\n      _iterator4.e(err);\n    } finally {\n      _iterator4.f();\n    }\n    return false;\n  };\n  var select_shop = function select_shop(name) {\n    var _iterator5 = _createForOfIteratorHelper(products[name]),\n      _step5;\n    try {\n      for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n        var product = _step5.value;\n        if (!selection.includes(product)) {\n          setSelection(products[name]);\n          return;\n        }\n      }\n    } catch (err) {\n      _iterator5.e(err);\n    } finally {\n      _iterator5.f();\n    }\n    setSelection([]);\n  };\n  var handle_change = function handle_change(id, val) {\n    var new_list = {};\n    for (var _i = 0, _Object$keys = Object.keys(products); _i < _Object$keys.length; _i++) {\n      var shop = _Object$keys[_i];\n      console.log(shop);\n      var temp = products[shop].slice(0);\n      var _iterator6 = _createForOfIteratorHelper(products[shop].entries()),\n        _step6;\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var _step6$value = _slicedToArray(_step6.value, 2),\n            i = _step6$value[0],\n            value = _step6$value[1];\n          console.log(value);\n          if (value.id === id) {\n            temp[i].count = val;\n          }\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n      console.log(temp);\n      new_list[shop] = temp;\n    }\n    setproduct(new_list);\n  };\n  var calc_price = function calc_price() {\n    var total = 0;\n    for (var _i2 = 0, _Object$values = Object.values(products); _i2 < _Object$values.length; _i2++) {\n      var items = _Object$values[_i2];\n      var _iterator7 = _createForOfIteratorHelper(items),\n        _step7;\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var item = _step7.value;\n          // 檢查是否在列表中\n          var _iterator8 = _createForOfIteratorHelper(selection),\n            _step8;\n          try {\n            for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n              var s = _step8.value;\n              if (s.id === item.id) {\n                total += item.count * item.price;\n                break;\n              }\n            }\n          } catch (err) {\n            _iterator8.e(err);\n          } finally {\n            _iterator8.f();\n          }\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    }\n    return total;\n  };\n  var handle_checkout = function handle_checkout() {\n    if (selection.length > 0) {\n      var id_list = selection.map(function (item) {\n        return item.id;\n      });\n      console.log(id_list);\n      document.cookie = \"orders=\".concat(JSON.stringify(id_list));\n      navigation(\"/cart/checkout\");\n    } else {\n      (0,_components_notification_js__WEBPACK_IMPORTED_MODULE_1__.FailNotify)(\"請選擇至少一項商品\");\n    }\n  };\n  react__WEBPACK_IMPORTED_MODULE_0___default().useEffect(function () {\n    if (products.length === 0) {\n      fetch(\"/api/product/GetProductsToCart\", {\n        method: \"POST\"\n      }).then(function (res) {\n        if (res.ok) {\n          return res.json();\n        }\n      }).then(function (data) {\n        if (data.cause === 0) {\n          var a = {};\n          var _iterator9 = _createForOfIteratorHelper(data.products),\n            _step9;\n          try {\n            for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n              var i = _step9.value;\n              var order_keys = Object.keys(a);\n              if (order_keys.includes(i.shop_name)) {\n                a[i.shop_name].push(i);\n              } else {\n                a[i.shop_name] = [i];\n              }\n            }\n          } catch (err) {\n            _iterator9.e(err);\n          } finally {\n            _iterator9.f();\n          }\n          setproduct(a);\n        }\n      });\n    }\n  }, [selection]);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react__WEBPACK_IMPORTED_MODULE_0___default().Fragment), null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(CartLowerBar, null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"main main_content grow\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(ContentTitle, null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"\"\n  }, Object.entries(products).map(function (order) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n      className: \"order_container\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(Order_title, {\n      shop_name: order[0],\n      onClick: select_shop,\n      isChecked: get_title_check(order[0])\n    }), order[1].map(function (i) {\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(Product, {\n        item: i,\n        onClick: select_product,\n        isChecked: get_item_check(i.id),\n        update: handle_change\n      });\n    }));\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(Footer, {\n    num: selection.length,\n    price: calc_price(),\n    onClick: handle_checkout\n  })));\n};\n\n//# sourceURL=webpack:///./pages/cart/cart.jsx?");

/***/ })

}]);